<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Dockerfile (dockerfile.Dockerfile)</title><meta charset="utf-8"/><link rel="stylesheet" href="../../odoc.support/odoc.css"/><meta name="generator" content="odoc 2.4.4"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../odoc.support/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../index.html">dockerfile</a> &#x00BB; Dockerfile</nav><header class="odoc-preamble"><h1>Module <code><span>Dockerfile</span></code></h1><p>Generate <code>Dockerfile</code> scripts for use with the Docker container manager</p></header><nav class="odoc-toc"><ul><li><a href="#core-combinators-and-serializers">Core combinators and serializers</a></li><li><a href="#dockerfile-commands">Dockerfile commands</a></li></ul></nav><div class="odoc-content"><h3 id="core-combinators-and-serializers"><a href="#core-combinators-and-serializers" class="anchor"></a>Core combinators and serializers</h3><div class="odoc-spec"><div class="spec type anchored" id="type-t"><a href="#type-t" class="anchor"></a><code><span><span class="keyword">type</span> t</span></code></div><div class="spec-doc"><p><code>t</code> is a list of Dockerfile lines</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-sexp_of_t"><a href="#val-sexp_of_t" class="anchor"></a><code><span><span class="keyword">val</span> sexp_of_t : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Sexplib</span>.Sexp.t</span></code></div><div class="spec-doc"><p><code>sexp_of_t t</code> converts a Dockerfile into a s-expression representation.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-t_of_sexp"><a href="#val-t_of_sexp" class="anchor"></a><code><span><span class="keyword">val</span> t_of_sexp : <span><span class="xref-unresolved">Sexplib</span>.Sexp.t <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p><code>t_of_sexp s</code> converts the <code>s</code> s-expression representation into a <a href="#type-t"><code>t</code></a>. The s-expression should have been generated using <a href="#val-sexp_of_t"><code>sexp_of_t</code></a>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-string_of_t"><a href="#val-string_of_t" class="anchor"></a><code><span><span class="keyword">val</span> string_of_t : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> string</span></code></div><div class="spec-doc"><p><code>string_of_t t</code> converts a <a href="#type-t"><code>t</code></a> into a Dockerfile format entry</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-pp"><a href="#val-pp" class="anchor"></a><code><span><span class="keyword">val</span> pp : <span><a href="#type-t">t</a> <span class="xref-unresolved">Fmt</span>.t</span></span></code></div><div class="spec-doc"><p><code>pp</code> is a formatter that outputs a <a href="#type-t"><code>t</code></a> in Dockerfile format.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-(@@)"><a href="#val-(@@)" class="anchor"></a><code><span><span class="keyword">val</span> (@@) : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p><code>a @@ b</code> concatenates two Dockerfile fragments into one.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-(@@@)"><a href="#val-(@@@)" class="anchor"></a><code><span><span class="keyword">val</span> (@@@) : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><span><a href="#type-t">t</a> list</span> <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p><code>a @@@ b</code> concatenates the <code>b</code> list of Dockerfile fragments onto <code>a</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-empty"><a href="#val-empty" class="anchor"></a><code><span><span class="keyword">val</span> empty : <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p>An empty set of instruction lines.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-maybe"><a href="#val-maybe" class="anchor"></a><code><span><span class="keyword">val</span> maybe : <span><span>(<span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a>)</span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> option</span> <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p><code>maybe f v</code> returns <a href="#val-empty"><code>empty</code></a> if the optional value <code>v</code> is <code>None</code>, and otherwise applies <code>f</code> to the <code>Some</code> value in <code>v</code>.</p></div></div><h3 id="dockerfile-commands"><a href="#dockerfile-commands" class="anchor"></a>Dockerfile commands</h3><div class="odoc-spec"><div class="spec type anchored" id="type-parser_directive"><a href="#type-parser_directive" class="anchor"></a><code><span><span class="keyword">type</span> parser_directive</span><span> = </span><span>[ </span></code><ol><li id="type-parser_directive.Syntax" class="def variant constructor anchored"><a href="#type-parser_directive.Syntax" class="anchor"></a><code><span>| </span><span>`Syntax <span class="keyword">of</span> string</span></code></li><li id="type-parser_directive.Escape" class="def variant constructor anchored"><a href="#type-parser_directive.Escape" class="anchor"></a><code><span>| </span><span>`Escape <span class="keyword">of</span> char</span></code></li></ol><code><span> ]</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-sexp_of_parser_directive"><a href="#val-sexp_of_parser_directive" class="anchor"></a><code><span><span class="keyword">val</span> sexp_of_parser_directive : <span><a href="#type-parser_directive">parser_directive</a> <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Sexplib0</span>.Sexp.t</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-parser_directive_of_sexp"><a href="#val-parser_directive_of_sexp" class="anchor"></a><code><span><span class="keyword">val</span> parser_directive_of_sexp : <span><span class="xref-unresolved">Sexplib0</span>.Sexp.t <span class="arrow">&#45;&gt;</span></span> <a href="#type-parser_directive">parser_directive</a></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-__parser_directive_of_sexp__"><a href="#val-__parser_directive_of_sexp__" class="anchor"></a><code><span><span class="keyword">val</span> __parser_directive_of_sexp__ : <span><span class="xref-unresolved">Sexplib0</span>.Sexp.t <span class="arrow">&#45;&gt;</span></span> <a href="#type-parser_directive">parser_directive</a></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-parser_directive"><a href="#val-parser_directive" class="anchor"></a><code><span><span class="keyword">val</span> parser_directive : <span><a href="#type-parser_directive">parser_directive</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p>A parser directive. If used, needs to be the first line of the Dockerfile.</p><ul class="at-tags"><li class="see"><span class="at-tag">see</span> <a href="https://docs.docker.com/engine/reference/builder/#parser-directives" class="value">https://docs.docker.com/engine/reference/builder/#parser-directives</a> </li></ul><ul class="at-tags"><li class="see"><span class="at-tag">see</span> <a href="https://docs.docker.com/build/buildkit/dockerfile-frontend/" class="value">https://docs.docker.com/build/buildkit/dockerfile-frontend/</a> </li></ul></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-buildkit_syntax"><a href="#val-buildkit_syntax" class="anchor"></a><code><span><span class="keyword">val</span> buildkit_syntax : <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p>Convenience function, returns the <a href="#val-parser_directive" title="parser_directive">parser directive</a> describing the latest BuildKit syntax.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-comment"><a href="#val-comment" class="anchor"></a><code><span><span class="keyword">val</span> comment : <span><span><span>(<span class="type-var">'a</span>, unit, string, <a href="#type-t">t</a>)</span> <span class="xref-unresolved">Stdlib</span>.format4</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span></span></code></div><div class="spec-doc"><p>Adds a comment to the Dockerfile for documentation purposes</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-heredoc"><a href="#type-heredoc" class="anchor"></a><code><span><span class="keyword">type</span> heredoc</span></code></div><div class="spec-doc"><p>Build here-document values with <a href="#val-heredoc"><code>heredoc</code></a>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-heredoc"><a href="#val-heredoc" class="anchor"></a><code><span><span class="keyword">val</span> heredoc : 
  <span><span class="optlabel">?strip</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?word</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?delimiter</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span><span>(<span class="type-var">'a</span>, unit, string, <a href="#type-heredoc">heredoc</a>)</span> <span class="xref-unresolved">Stdlib</span>.format4</span> <span class="arrow">&#45;&gt;</span></span>
  <span class="type-var">'a</span></span></code></div><div class="spec-doc"><p><code>heredoc ~word here_document</code> creates a <a href="#type-heredoc"><code>heredoc</code></a> value with <code>here_document</code> as content and <code>word</code> () as opening delimiter. If <code>word</code> is quoted, then <code>delimiter</code> (unquoted <code>word</code>) needs to be specified. Quoting affects expansion in the here-document. Requires 1.4 <a href="#val-buildkit_syntax"><code>buildkit_syntax</code></a>.</p><ul class="at-tags"><li class="parameter"><span class="at-tag">parameter</span> <span class="value">strip</span> <p>Whether to strip leading tab characters. Defaults to false.</p></li></ul><ul class="at-tags"><li class="parameter"><span class="at-tag">parameter</span> <span class="value">word</span> <p>The opening delimiter, possibly quoted. Defaults to <code>EOF</code>.</p></li></ul><ul class="at-tags"><li class="parameter"><span class="at-tag">parameter</span> <span class="value">delimiter</span> <p>The closing delimiter, unquoted. Defaults to the content of <code>word</code>.</p></li></ul><ul class="at-tags"><li class="see"><span class="at-tag">see</span> <a href="https://pubs.opengroup.org/onlinepubs/9699919799/utilities/V3_chap02.html#tag_18_07_04" class="value">https://pubs.opengroup.org/onlinepubs/9699919799/utilities/V3_chap02.html#tag_18_07_04</a> <p>POSIX 2.7.4 Here-Document</p></li></ul><ul class="at-tags"><li class="see"><span class="at-tag">see</span> <a href="https://github.com/moby/buildkit/blob/master/frontend/dockerfile/docs/syntax.md#here-documents" class="value">https://github.com/moby/buildkit/blob/master/frontend/dockerfile/docs/syntax.md#here-documents</a> <p>BuildKit Here-Documents</p></li></ul></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-from"><a href="#val-from" class="anchor"></a><code><span><span class="keyword">val</span> from : <span><span class="optlabel">?alias</span>:string <span class="arrow">&#45;&gt;</span></span> <span><span class="optlabel">?tag</span>:string <span class="arrow">&#45;&gt;</span></span> <span><span class="optlabel">?platform</span>:string <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p>The <code>from</code> instruction sets the base image for subsequent instructions.</p><ul><li>A valid Dockerfile must have <code>from</code> as its first instruction. The image can be any valid image.</li><li><code>from</code> must be the first non-comment instruction in the Dockerfile.</li><li><code>from</code> can appear multiple times within a single Dockerfile in order to create multiple images. Multiple FROM commands will result in a multi-stage build, and the <code>?from</code> argument to the <a href="#val-copy"><code>copy</code></a> and <a href="#val-add"><code>add</code></a> functions can move artefacts across stages.</li></ul><p>By default, the stages are not named, and you refer to them by their integer number, starting with 0 for the first <code>FROM</code> instruction. However, you can name your stages, by supplying an <code>?alias</code> argument. The alias can be supplied to the <code>?from</code> parameter to <a href="#val-copy"><code>copy</code></a> or <a href="#val-add"><code>add</code></a> to refer to this particular stage by name.</p><p>If no <code>tag</code> is supplied, <code>latest</code> is assumed. If the used tag does not exist, an error will be returned.</p><p>The optional <code>platform</code> flag can be used to specify the platform of the image in case the <code>from</code> references a multi-platform image. For example, <code>linux/386</code> could be used. By default, the target platform of the build request is ued if this is not specified.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-maintainer"><a href="#val-maintainer" class="anchor"></a><code><span><span class="keyword">val</span> maintainer : <span><span><span>(<span class="type-var">'a</span>, unit, string, <a href="#type-t">t</a>)</span> <span class="xref-unresolved">Stdlib</span>.format4</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span></span></code></div><div class="spec-doc"><p><code>maintainer</code> sets the author field of the generated images.</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-mount"><a href="#type-mount" class="anchor"></a><code><span><span class="keyword">type</span> mount</span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-network"><a href="#type-network" class="anchor"></a><code><span><span class="keyword">type</span> network</span><span> = </span><span>[ </span></code><ol><li id="type-network.Default" class="def variant constructor anchored"><a href="#type-network.Default" class="anchor"></a><code><span>| </span><span>`Default</span></code></li><li id="type-network.None" class="def variant constructor anchored"><a href="#type-network.None" class="anchor"></a><code><span>| </span><span>`None</span></code></li><li id="type-network.Host" class="def variant constructor anchored"><a href="#type-network.Host" class="anchor"></a><code><span>| </span><span>`Host</span></code></li></ol><code><span> ]</span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-security"><a href="#type-security" class="anchor"></a><code><span><span class="keyword">type</span> security</span><span> = </span><span>[ </span></code><ol><li id="type-security.Insecure" class="def variant constructor anchored"><a href="#type-security.Insecure" class="anchor"></a><code><span>| </span><span>`Insecure</span></code></li><li id="type-security.Sandbox" class="def variant constructor anchored"><a href="#type-security.Sandbox" class="anchor"></a><code><span>| </span><span>`Sandbox</span></code></li></ol><code><span> ]</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-run"><a href="#val-run" class="anchor"></a><code><span><span class="keyword">val</span> run : 
  <span><span class="optlabel">?mounts</span>:<span><a href="#type-mount">mount</a> list</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?network</span>:<a href="#type-network">network</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?security</span>:<a href="#type-security">security</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span>(<span class="type-var">'a</span>, unit, string, <a href="#type-t">t</a>)</span> <span class="xref-unresolved">Stdlib</span>.format4</span> <span class="arrow">&#45;&gt;</span></span>
  <span class="type-var">'a</span></span></code></div><div class="spec-doc"><p><code>run ?mounts ?network ?security fmt</code> will execute any commands in a new layer on top of the current image and commit the results. The resulting committed image will be used for the next step in the Dockerfile. The string result of formatting <code>arg</code> will be passed as a <code>/bin/sh -c</code> invocation.</p><ul class="at-tags"><li class="parameter"><span class="at-tag">parameter</span> <span class="value">mounts</span> <p>A list of filesystem mounts that the build can access. Requires <a href="#val-buildkit_syntax"><code>buildkit_syntax</code></a> 1.2.</p></li></ul><ul class="at-tags"><li class="parameter"><span class="at-tag">parameter</span> <span class="value">network</span> <p>Control which networking environment the command is run in. Requires <a href="#val-buildkit_syntax"><code>buildkit_syntax</code></a> 1.1. Requires BuildKit <a href="#val-parser_directive" title="parser_directive">syntax</a> 1.1.</p></li></ul><ul class="at-tags"><li class="parameter"><span class="at-tag">parameter</span> <span class="value">security</span> <p>Control which security mode the command is run in. Requires BuildKit <a href="#val-parser_directive" title="parser_directive">syntax</a> 1-labs.</p></li></ul></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-run_exec"><a href="#val-run_exec" class="anchor"></a><code><span><span class="keyword">val</span> run_exec : 
  <span><span class="optlabel">?mounts</span>:<span><a href="#type-mount">mount</a> list</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?network</span>:<a href="#type-network">network</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?security</span>:<a href="#type-security">security</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span>string list</span> <span class="arrow">&#45;&gt;</span></span>
  <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p><code>run_exec ?mounts ?network ?security args</code> will execute any commands in a new layer on top of current image and commit the results. The resulting committed image will be used for the next step in the Dockerfile. The <code>cmd</code> form makes it possible to avoid shell string munging, and to run commands using a base image that does not contain <code>/bin/sh</code>.</p><ul class="at-tags"><li class="parameter"><span class="at-tag">parameter</span> <span class="value">mounts</span> <p>A list of filesystem mounts that the build can access. Requires <a href="#val-buildkit_syntax"><code>buildkit_syntax</code></a> 1.2.</p></li></ul><ul class="at-tags"><li class="parameter"><span class="at-tag">parameter</span> <span class="value">network</span> <p>Control which networking environment the command is run in. Requires <a href="#val-buildkit_syntax"><code>buildkit_syntax</code></a> 1.1.</p></li></ul><ul class="at-tags"><li class="parameter"><span class="at-tag">parameter</span> <span class="value">security</span> <p>Control which security mode the command is run in. Requires BuildKit <a href="#val-parser_directive" title="parser_directive">syntax</a> 1-labs.</p></li></ul></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-run_heredoc"><a href="#val-run_heredoc" class="anchor"></a><code><span><span class="keyword">val</span> run_heredoc : 
  <span><span class="optlabel">?mounts</span>:<span><a href="#type-mount">mount</a> list</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?network</span>:<a href="#type-network">network</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?security</span>:<a href="#type-security">security</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span>(<a href="#type-heredoc">heredoc</a> * <span>string option</span>)</span> list</span> <span class="arrow">&#45;&gt;</span></span>
  <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p><code>run_heredoc ?mounts ?network ?security docs</code> will execute any commands in a new layer on top of the current image and commit the results. The resulting committed image will be used for the next step in the Dockerfile. The string result of formatting <code>arg</code> will be passed as a <code>/bin/sh -c</code> invocation.</p><ul class="at-tags"><li class="parameter"><span class="at-tag">parameter</span> <span class="value">mounts</span> <p>A list of filesystem mounts that the build can access. Requires <a href="#val-buildkit_syntax"><code>buildkit_syntax</code></a> 1.2.</p></li></ul><ul class="at-tags"><li class="parameter"><span class="at-tag">parameter</span> <span class="value">network</span> <p>Control which networking environment the command is run in. Requires <a href="#val-buildkit_syntax"><code>buildkit_syntax</code></a> 1.1. Requires BuildKit <a href="#val-parser_directive" title="parser_directive">syntax</a> 1.1.</p></li></ul><ul class="at-tags"><li class="parameter"><span class="at-tag">parameter</span> <span class="value">security</span> <p>Control which security mode the command is run in. Requires BuildKit <a href="#val-parser_directive" title="parser_directive">syntax</a> 1-labs.</p></li></ul></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-mount_bind"><a href="#val-mount_bind" class="anchor"></a><code><span><span class="keyword">val</span> mount_bind : 
  <span><span class="label">target</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?source</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?from</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?readwrite</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span>unit <span class="arrow">&#45;&gt;</span></span>
  <a href="#type-mount">mount</a></span></code></div><div class="spec-doc"><p><code>mount_bind ~target ?source ?from ?readwrite ()</code> Creates a bind mount for <a href="#val-run"><code>run</code></a>.</p><p>Requires <a href="#val-buildkit_syntax"><code>buildkit_syntax</code></a>.</p><ul class="at-tags"><li class="parameter"><span class="at-tag">parameter</span> <span class="value">target</span> <p>the target of the mount inside the container. Usually a path, but for 'podman' it can also contain SELinux flags like ',z' or ',Z'</p></li></ul><ul class="at-tags"><li class="parameter"><span class="at-tag">parameter</span> <span class="value">from</span> <p>a build stage to bind mount from (if absent: bind mount host)</p></li></ul><ul class="at-tags"><li class="parameter"><span class="at-tag">parameter</span> <span class="value">source</span> <p>path to mount. When <code>from</code> is absent this is relative to the build context on the host. When <code>source</code> is absent it defaults to root of <code>from</code>.</p></li></ul><ul class="at-tags"><li class="parameter"><span class="at-tag">parameter</span> <span class="value">readwrite</span> <p>enables writing to the mount (default: read-only). The data written is not persisted, <code>source</code> always remains unchanged.</p></li></ul><ul class="at-tags"><li class="see"><span class="at-tag">see</span> <a href="https://docs.docker.com/engine/ruference/builder/#run---mounttypebind" class="value">https://docs.docker.com/engine/ruference/builder/#run---mounttypebind</a> <p>Docker --mount=type=bind reference</p></li></ul></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-mount_cache"><a href="#val-mount_cache" class="anchor"></a><code><span><span class="keyword">val</span> mount_cache : 
  <span><span class="optlabel">?id</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">target</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?readonly</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?sharing</span>:<span>[ `Locked <span>| `Private</span> <span>| `Shared</span> ]</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?from</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?source</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?mode</span>:int <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?uid</span>:int <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?gid</span>:int <span class="arrow">&#45;&gt;</span></span>
  <span>unit <span class="arrow">&#45;&gt;</span></span>
  <a href="#type-mount">mount</a></span></code></div><div class="spec-doc"><p><code>mount_cache ?id ~target ?readonly ?sharing ?from ?source ?mode ?uid ?gid
     ()</code> Creates a cache mount for <a href="#val-run"><code>run</code></a>.</p><p>Requires <a href="#val-buildkit_syntax"><code>buildkit_syntax</code></a>.</p><ul class="at-tags"><li class="parameter"><span class="at-tag">parameter</span> <span class="value">id</span> <p>the cache id: all container builds with same cache id (even from other unrelated builds) will get the same writable directory mounted. Defaults to <code>target</code> when absent.</p></li></ul><ul class="at-tags"><li class="parameter"><span class="at-tag">parameter</span> <span class="value">target</span> <p>where to mount the cache inside the container. The <code>RUN</code> command needs to cope with a completely empty cache, and with files from the cache being deleted by the container runtime's GC in arbitrary order. E.g. a download cache would be suitable here, an entire git repository wouldn't. Also make sure that your RUN commands doesn't inadvertently wipe the cache (e.g. apt inside a container by default would).</p></li></ul><ul class="at-tags"><li class="parameter"><span class="at-tag">parameter</span> <span class="value">readonly</span> <p>whether the cache is read-only (by default it is writable)</p></li></ul><ul class="at-tags"><li class="parameter"><span class="at-tag">parameter</span> <span class="value">sharing</span> <p>how to share the cache between concurrent builds. The default is <code>`Shared</code> which doesn't use any locking.</p></li></ul><ul class="at-tags"><li class="parameter"><span class="at-tag">parameter</span> <span class="value">from</span> <p>the stage to use for the initial contents of the cache.</p></li></ul><ul class="at-tags"><li class="parameter"><span class="at-tag">parameter</span> <span class="value">source</span> <p>the initial contents of the cache, default is empty.</p></li></ul><ul class="at-tags"><li class="parameter"><span class="at-tag">parameter</span> <span class="value">mode</span> <p>file mode for cache directory</p></li></ul><ul class="at-tags"><li class="parameter"><span class="at-tag">parameter</span> <span class="value">uid</span> <p>UID of cache directory, default 0.</p></li></ul><ul class="at-tags"><li class="parameter"><span class="at-tag">parameter</span> <span class="value">gid</span> <p>GID of cache directory, default 0.</p></li></ul><ul class="at-tags"><li class="see"><span class="at-tag">see</span> <a href="https://docs.docker.com/engine/reference/builder/#run---mounttypecache" class="value">https://docs.docker.com/engine/reference/builder/#run---mounttypecache</a> <p>Docker --mount=type=cache reference</p></li></ul></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-mount_tmpfs"><a href="#val-mount_tmpfs" class="anchor"></a><code><span><span class="keyword">val</span> mount_tmpfs : <span><span class="label">target</span>:string <span class="arrow">&#45;&gt;</span></span> <span><span class="optlabel">?size</span>:int <span class="arrow">&#45;&gt;</span></span> <span>unit <span class="arrow">&#45;&gt;</span></span> <a href="#type-mount">mount</a></span></code></div><div class="spec-doc"><p><code>mount_tmpfs ~target ?size ())</code> Creates a tmpfs mount for <a href="#val-run"><code>run</code></a>.</p><p>Requires <a href="#val-buildkit_syntax"><code>buildkit_syntax</code></a>.</p><ul class="at-tags"><li class="parameter"><span class="at-tag">parameter</span> <span class="value">target</span> <p>mounts a <code>tmpfs</code> at <code>target</code></p></li></ul><ul class="at-tags"><li class="parameter"><span class="at-tag">parameter</span> <span class="value">size</span> <p>maximum size of <code>tmpfs</code> (only supported by Docker)</p><p>Note that the directory seems to be completely removed from the image, so once you start using <code>tmpfs</code> for a dir, it is recommended that all further <code>RUN</code> commands use it too to avoid ENOENT errors.</p></li></ul><ul class="at-tags"><li class="see"><span class="at-tag">see</span> <a href="https://docs.docker.com/engine/reference/builder/#run---mounttypetmpfs" class="value">https://docs.docker.com/engine/reference/builder/#run---mounttypetmpfs</a> <p>Docker --mount=type=tmpfs reference</p></li></ul></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-mount_secret"><a href="#val-mount_secret" class="anchor"></a><code><span><span class="keyword">val</span> mount_secret : 
  <span><span class="optlabel">?id</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?target</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?required</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?mode</span>:int <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?uid</span>:int <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?gid</span>:int <span class="arrow">&#45;&gt;</span></span>
  <span>unit <span class="arrow">&#45;&gt;</span></span>
  <a href="#type-mount">mount</a></span></code></div><div class="spec-doc"><p><code>mount_secret ?id ?target ?required ?mode ?uid ?gid</code> Creates a secret mount for <a href="#val-run"><code>run</code></a>.</p><p>Requires <a href="#val-buildkit_syntax"><code>buildkit_syntax</code></a>.</p><ul class="at-tags"><li class="see"><span class="at-tag">see</span> <a href="https://docs.docker.com/engine/reference/builder/#run---mounttypesecret" class="value">https://docs.docker.com/engine/reference/builder/#run---mounttypesecret</a> <p>Docker --mount=type=secret reference</p></li></ul></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-mount_ssh"><a href="#val-mount_ssh" class="anchor"></a><code><span><span class="keyword">val</span> mount_ssh : 
  <span><span class="optlabel">?id</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?target</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?required</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?mode</span>:int <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?uid</span>:int <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?gid</span>:int <span class="arrow">&#45;&gt;</span></span>
  <span>unit <span class="arrow">&#45;&gt;</span></span>
  <a href="#type-mount">mount</a></span></code></div><div class="spec-doc"><p><code>mount_ssh ?id ?target ?required ?mode ?uid ?gid</code> Creates an ssh mount for <a href="#val-run"><code>run</code></a>.</p><p>Requires <a href="#val-buildkit_syntax"><code>buildkit_syntax</code></a>.</p><p>Seems to be only supported by Docker at the moment.</p><ul class="at-tags"><li class="see"><span class="at-tag">see</span> <a href="https://docs.docker.com/engine/reference/builder/#run---mounttypessh" class="value">https://docs.docker.com/engine/reference/builder/#run---mounttypessh</a> <p>Docker --mount=type=ssh reference</p></li></ul></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-cmd"><a href="#val-cmd" class="anchor"></a><code><span><span class="keyword">val</span> cmd : <span><span><span>(<span class="type-var">'a</span>, unit, string, <a href="#type-t">t</a>)</span> <span class="xref-unresolved">Stdlib</span>.format4</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span></span></code></div><div class="spec-doc"><p><code>cmd args</code> provides defaults for an executing container. These defaults can include an executable, or they can omit the executable, in which case you must specify an <a href="#val-entrypoint"><code>entrypoint</code></a> as well. The string result of formatting <code>arg</code> will be passed as a <code>/bin/sh -c</code> invocation.</p><p>There can only be one <code>cmd</code> in a Dockerfile. If you list more than one then only the last <code>cmd</code> will take effect.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-cmd_exec"><a href="#val-cmd_exec" class="anchor"></a><code><span><span class="keyword">val</span> cmd_exec : <span><span>string list</span> <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p><code>cmd_exec args</code> provides defaults for an executing container. These defaults can include an executable, or they can omit the executable, in which case you must specify an <a href="#val-entrypoint"><code>entrypoint</code></a> as well. The first argument to the <code>args</code> list must be the full path to the executable.</p><p>There can only be one <code>cmd</code> in a Dockerfile. If you list more than one then only the last <code>cmd</code> will take effect.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-expose_port"><a href="#val-expose_port" class="anchor"></a><code><span><span class="keyword">val</span> expose_port : <span>int <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p><code>expose_port</code> informs Docker that the container will listen on the specified network port at runtime.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-expose_ports"><a href="#val-expose_ports" class="anchor"></a><code><span><span class="keyword">val</span> expose_ports : <span><span>int list</span> <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p><code>expose_ports</code> informs Docker that the container will listen on the specified network ports at runtime.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-arg"><a href="#val-arg" class="anchor"></a><code><span><span class="keyword">val</span> arg : <span><span class="optlabel">?default</span>:string <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p><code>arg ~default name</code> defines a variable that users can pass at build-time to the builder with the docker build command using the <code>--build-arg &lt;varname&gt;=&lt;value&gt;</code> flag. It can optionally include a default value.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-env"><a href="#val-env" class="anchor"></a><code><span><span class="keyword">val</span> env : <span><span><span>(string * string)</span> list</span> <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p><code>env</code> sets the list of environment variables supplied with the (&lt;key&gt;, &lt;value&gt;) tuple. This value will be passed to all future <a href="#val-run"><code>run</code></a> instructions. This is functionally equivalent to prefixing a shell command with <code>&lt;key&gt;=&lt;value&gt;</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-add"><a href="#val-add" class="anchor"></a><code><span><span class="keyword">val</span> add : 
  <span><span class="optlabel">?link</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?chown</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?chmod</span>:int <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?from</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?checksum</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?keep_git_dir</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">src</span>:<span>string list</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">dst</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span>unit <span class="arrow">&#45;&gt;</span></span>
  <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p><code>add ?link ?chown ?chmod ?from ~src ~dst ()</code> copies new files, directories or remote file URLs from <code>src</code> and adds them to the filesystem of the container at the <code>dst</code> path.</p><p>Multiple <code>src</code> resource may be specified but if they are files or directories then they must be relative to the source directory that is being built (the context of the build).</p><p>Each <code>src</code> may contain wildcards and matching will be done using Go's filepath.Match rules.</p><p>All new files and directories are created with a UID and GID of 0. In the case where <code>src</code> is a remote file URL, the destination will have permissions of 600. If the remote file being retrieved has an HTTP Last-Modified header, the timestamp from that header will be used to set the mtime on the destination file. Then, like any other file processed during an ADD, mtime will be included in the determination of whether or not the file has changed and the cache should be updated.</p><ul class="at-tags"><li class="parameter"><span class="at-tag">parameter</span> <span class="value">link</span> <p>Add files with enhanced semantics where your files remain independent on their own layer and donâ€™t get invalidated when commands on previous layers are changed. Requires 1.4 <a href="#val-buildkit_syntax"><code>buildkit_syntax</code></a>.</p></li></ul><ul class="at-tags"><li class="parameter"><span class="at-tag">parameter</span> <span class="value">chown</span> <p>Specify a given username, groupname, or UID/GID combination to request specific ownership of the copied content.</p></li></ul><ul class="at-tags"><li class="parameter"><span class="at-tag">parameter</span> <span class="value">chmod</span> <p>Specify permissions on the files. Only supported on Linux, with Dockerfile syntax 1.3.</p></li></ul><ul class="at-tags"><li class="parameter"><span class="at-tag">parameter</span> <span class="value">from</span> <p>Allows artefacts to be retrieved from multiple stages. It can either be an integer number (starting with 0 for the first <a href="#val-from"><code>from</code></a> stage, or a named stage (supplied via <code>?alias</code> to the <a href="#val-from"><code>from</code></a> command).</p></li></ul><ul class="at-tags"><li class="parameter"><span class="at-tag">parameter</span> <span class="value">checksum</span> <p>Verify a remote file checksum.</p></li></ul><ul class="at-tags"><li class="parameter"><span class="at-tag">parameter</span> <span class="value">keep_git_dir</span> <p>When cloning a Git repository, the flag adds the <code>.git</code> directory. This flag defaults to false.</p></li></ul></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-copy"><a href="#val-copy" class="anchor"></a><code><span><span class="keyword">val</span> copy : 
  <span><span class="optlabel">?link</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?chown</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?chmod</span>:int <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?from</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">src</span>:<span>string list</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">dst</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span>unit <span class="arrow">&#45;&gt;</span></span>
  <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p><code>copy ?link ?chown ?from ~src ~dst ()</code> copies new files or directories from <code>src</code> and adds them to the filesystem of the container at the path <code>dst</code>. See <a href="#val-add"><code>add</code></a> for more detailed documentation.</p><ul class="at-tags"><li class="parameter"><span class="at-tag">parameter</span> <span class="value">link</span> <p>Copy files with enhanced semantics where your files remain independent on their own layer and donâ€™t get invalidated when commands on previous layers are changed. Requires 1.4 <a href="#val-buildkit_syntax"><code>buildkit_syntax</code></a>.</p></li></ul><ul class="at-tags"><li class="parameter"><span class="at-tag">parameter</span> <span class="value">chown</span> <p>Specify a given username, groupname, or UID/GID combination to request specific ownership of the copied content.</p></li></ul><ul class="at-tags"><li class="parameter"><span class="at-tag">parameter</span> <span class="value">chmod</span> <p>Specify permissions on the files. Only supported on Linux, with Dockerfile syntax 1.3.</p></li></ul><ul class="at-tags"><li class="parameter"><span class="at-tag">parameter</span> <span class="value">from</span> <p>Allows artefacts to be retrieved from multiple stages. It can either be an integer number (starting with 0 for the first <a href="#val-from"><code>from</code></a> stage, or a named stage (supplied via <code>?alias</code> to the <a href="#val-from"><code>from</code></a> command).</p></li></ul></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-copy_heredoc"><a href="#val-copy_heredoc" class="anchor"></a><code><span><span class="keyword">val</span> copy_heredoc : 
  <span><span class="optlabel">?chown</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?chmod</span>:int <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">src</span>:<span><a href="#type-heredoc">heredoc</a> list</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">dst</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span>unit <span class="arrow">&#45;&gt;</span></span>
  <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p><code>copy_heredoc src dst</code> creates the file <code>dst</code> using the content of the here-documents <code>src</code>. Requires 1.4 <a href="#val-buildkit_syntax"><code>buildkit_syntax</code></a>.</p><ul class="at-tags"><li class="see"><span class="at-tag">see</span> <a href="https://github.com/moby/buildkit/blob/master/frontend/dockerfile/docs/syntax.md#here-documents" class="value">https://github.com/moby/buildkit/blob/master/frontend/dockerfile/docs/syntax.md#here-documents</a> </li></ul></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-user"><a href="#val-user" class="anchor"></a><code><span><span class="keyword">val</span> user : <span><span><span>(<span class="type-var">'a</span>, unit, string, <a href="#type-t">t</a>)</span> <span class="xref-unresolved">Stdlib</span>.format4</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span></span></code></div><div class="spec-doc"><p><code>user fmt</code> sets the user name or UID to use when running the image and for any <a href="#val-run"><code>run</code></a>, <a href="#val-cmd"><code>cmd</code></a>, <a href="#val-entrypoint"><code>entrypoint</code></a> commands that follow it in the Dockerfile.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-workdir"><a href="#val-workdir" class="anchor"></a><code><span><span class="keyword">val</span> workdir : <span><span><span>(<span class="type-var">'a</span>, unit, string, <a href="#type-t">t</a>)</span> <span class="xref-unresolved">Stdlib</span>.format4</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span></span></code></div><div class="spec-doc"><p><code>workdir fmt</code> sets the working directory for any <a href="#val-run"><code>run</code></a>, <a href="#val-cmd"><code>cmd</code></a> and <a href="#val-entrypoint"><code>entrypoint</code></a> instructions that follow it in the Dockerfile.</p><p>It can be used multiple times in the one Dockerfile. If a relative path is provided, it will be relative to the path of the previous <a href="#val-workdir"><code>workdir</code></a> instruction.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-volume"><a href="#val-volume" class="anchor"></a><code><span><span class="keyword">val</span> volume : <span><span><span>(<span class="type-var">'a</span>, unit, string, <a href="#type-t">t</a>)</span> <span class="xref-unresolved">Stdlib</span>.format4</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span></span></code></div><div class="spec-doc"><p><code>volume fmt</code> will create a mount point with the specified name and mark it as holding externally mounted volumes from native host or other containers. The value can be a JSON array or a plain string with multiple arguments that specify several mount points.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-volumes"><a href="#val-volumes" class="anchor"></a><code><span><span class="keyword">val</span> volumes : <span><span>string list</span> <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p><code>volumes mounts</code> will create mount points with the specified names in <code>mounts</code> and mark them as holding externally mounted volumes from native host or other containers.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-entrypoint"><a href="#val-entrypoint" class="anchor"></a><code><span><span class="keyword">val</span> entrypoint : <span><span><span>(<span class="type-var">'a</span>, unit, string, <a href="#type-t">t</a>)</span> <span class="xref-unresolved">Stdlib</span>.format4</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span></span></code></div><div class="spec-doc"><p><code>entrypoint fmt</code> allows you to configure a container that will run as an executable. The <code>fmt</code> string will be executed using a <code>/bin/sh</code> subshell.</p><p>The shell form prevents any <a href="#val-cmd"><code>cmd</code></a> or <a href="#val-run"><code>run</code></a> command line arguments from being used, but has the disadvantage that your <a href="#val-entrypoint"><code>entrypoint</code></a> will be started as a subcommand of <code>/bin/sh -c</code>, which does not pass signals. This means that the executable will not be the container's PID 1 - and will not receive Unix signals - so your executable will not receive a SIGTERM from <code>docker stop &lt;container&gt;</code>.</p><p>To get around this limitation, use the <a href="#val-entrypoint_exec"><code>entrypoint_exec</code></a> command to directly execute an argument list without a subshell.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-entrypoint_exec"><a href="#val-entrypoint_exec" class="anchor"></a><code><span><span class="keyword">val</span> entrypoint_exec : <span><span>string list</span> <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p><code>entrypoint fmt</code> allows you to configure a container that will run as an executable. You can use the exec form here to set fairly stable default commands and arguments and then use either <a href="#val-cmd"><code>cmd</code></a> or <a href="#val-cmd_exec"><code>cmd_exec</code></a> to set additional defaults that are more likely to be changed by the user starting the Docker container.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-shell"><a href="#val-shell" class="anchor"></a><code><span><span class="keyword">val</span> shell : <span><span>string list</span> <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p><code>shell t</code> allows the default shell used for the shell form of commands to be overridden. The default shell on Linux is <code>&quot;/bin/sh&quot;; &quot;-c&quot;</code>, and on Windows is <code>&quot;cmd&quot;; &quot;/S&quot;; &quot;/C&quot;</code>. The <code>shell</code> instruction can appear multiple times. Each <code>shell</code> instruction overrides all previous <code>shell</code> instructions, and affects all subsequent instructions.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-onbuild"><a href="#val-onbuild" class="anchor"></a><code><span><span class="keyword">val</span> onbuild : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p><code>onbuild t</code> adds to the image a trigger instruction <code>t</code> to be executed at a later time, when the image is used as the base for another build. The trigger will be executed in the context of the downstream build, as if it had been inserted immediately after the <a href="#val-from"><code>from</code></a> instruction in the downstream Dockerfile.</p><p>Any build instruction can be registered as a trigger.</p><p>This is useful if you are building an image which will be used as a base to build other images, for example an application build environment or a daemon which may be customized with user-specific configuration.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-label"><a href="#val-label" class="anchor"></a><code><span><span class="keyword">val</span> label : <span><span><span>(string * string)</span> list</span> <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p><code>label l</code> adds metadata to an image via a list of key-value pairs. To include spaces within a label value, use quotes and backslashes as you would in command-line parsing. An image can have more than one label. To specify multiple labels, Docker recommends combining labels into a single label instruction where possible. Each label instruction produces a new layer which can result in an inefficient image if you use many labels.</p><p>Labels are additive including <code>LABEL</code>s in <code>FROM</code> images. If Docker encounters a label/key that already exists, the new value overrides any previous labels with identical keys.</p><p>To view an imageâ€™s labels, use the <code>docker inspect</code> command.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-healthcheck"><a href="#val-healthcheck" class="anchor"></a><code><span><span class="keyword">val</span> healthcheck : 
  <span><span class="optlabel">?interval</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?timeout</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?start_period</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?start_interval</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?retries</span>:int <span class="arrow">&#45;&gt;</span></span>
  <span><span><span>(<span class="type-var">'a</span>, unit, string, <a href="#type-t">t</a>)</span> <span class="xref-unresolved">Stdlib</span>.format4</span> <span class="arrow">&#45;&gt;</span></span>
  <span class="type-var">'a</span></span></code></div><div class="spec-doc"><p><code>healthcheck cmd</code> checks container health by running a command inside the container. See <a href="#val-cmd"><code>cmd</code></a> for additional details.</p><ul class="at-tags"><li class="parameter"><span class="at-tag">parameter</span> <span class="value">interval</span> <p>The health check will first run <code>interval</code> seconds after the container is started, and then again <code>interval</code> seconds after each previous check completes.</p></li></ul><ul class="at-tags"><li class="parameter"><span class="at-tag">parameter</span> <span class="value">timeout</span> <p>If a single run of the check takes longer than <code>timeout</code> seconds then the check is considered to have failed.</p></li></ul><ul class="at-tags"><li class="parameter"><span class="at-tag">parameter</span> <span class="value">start_period</span> <p>provides initialization time for containers that need time to bootstrap. Probe failure during that period will not be counted towards the maximum number of retries. However, if a health check succeeds during the start period, the container is considered started and all consecutive failures will be counted towards the maximum number of retries.</p></li></ul><ul class="at-tags"><li class="parameter"><span class="at-tag">parameter</span> <span class="value">start_interval</span> <p>is the time between health checks during the start period.</p></li></ul><ul class="at-tags"><li class="parameter"><span class="at-tag">parameter</span> <span class="value">retries</span> <p>It takes <code>retries</code> consecutive failures of the health check for the container to be considered <i>unhealthy</i>.</p></li></ul></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-healthcheck_exec"><a href="#val-healthcheck_exec" class="anchor"></a><code><span><span class="keyword">val</span> healthcheck_exec : 
  <span><span class="optlabel">?interval</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?timeout</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?start_period</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?start_interval</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="optlabel">?retries</span>:int <span class="arrow">&#45;&gt;</span></span>
  <span><span>string list</span> <span class="arrow">&#45;&gt;</span></span>
  <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p><code>healthcheck_exec cmd</code> checks container health by running a command inside the container. See <a href="#val-cmd_exec"><code>cmd_exec</code></a> and <a href="#val-healthcheck"><code>healthcheck</code></a> for additional details.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-healthcheck_none"><a href="#val-healthcheck_none" class="anchor"></a><code><span><span class="keyword">val</span> healthcheck_none : <span>unit <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p><code>healthcheck_none</code> disables any healthcheck inherited from the base image.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-stopsignal"><a href="#val-stopsignal" class="anchor"></a><code><span><span class="keyword">val</span> stopsignal : <span>string <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p><code>stopsignal signal</code> sets the system call signal that will be sent to the container to exit.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-crunch"><a href="#val-crunch" class="anchor"></a><code><span><span class="keyword">val</span> crunch : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p><code>crunch t</code> will reduce coincident <a href="#val-run"><code>run</code></a> commands into a single one that is chained using the shell <code>&amp;&amp;</code> operator. This reduces the number of layers required for a production image.</p><ul class="at-tags"><li class="raises"><span class="at-tag">raises</span> <code>Invalid_argument</code> <p>if mounts or networks or security modes differ for each run command.</p></li></ul></div></div></div></body></html>
